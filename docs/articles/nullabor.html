<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to the nullabor package • nullabor</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to the nullabor package">
<meta property="og:description" content="nullabor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nullabor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/nullabor.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/distances.html">Distances between null and data plots</a>
    </li>
    <li>
      <a href="../articles/nullabor-distributions.html">Assessing distributional assumptions using the nullabor package</a>
    </li>
    <li>
      <a href="../articles/nullabor-examples.html">Example lineups</a>
    </li>
    <li>
      <a href="../articles/nullabor-regression.html">Residual plots for linear models using the nullabor package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dicook/nullabor/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An Introduction to the nullabor package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dicook/nullabor/blob/HEAD/vignettes/nullabor.Rmd" class="external-link"><code>vignettes/nullabor.Rmd</code></a></small>
      <div class="hidden name"><code>nullabor.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="an-introduction-to-the-nullabor-package">An introduction to the <strong>nullabor</strong> package<a class="anchor" aria-label="anchor" href="#an-introduction-to-the-nullabor-package"></a>
</h2>
<p>The <strong>nullabor</strong> package provides functions to support
quantifying the significance of structure seen in plots of data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dicook/nullabor" class="external-link">nullabor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<p>The functions provide methods for two protocols:
<strong><em>lineup</em></strong> and
<strong><em>rorschach</em></strong>. The lineup protocol places the plot
of the actual data among a field of plots of null data, and in the
Rorschach, all plots are of null data. The
<strong><em>encrypt</em></strong> function enables the location of the
actual data plot to be a secret, that needs
<strong><em>decrypt</em></strong> to reveal. There are several different
functions for generating null data sets:
<strong><em>null_permute</em></strong>,
<strong><em>null_lm</em></strong> and
<strong><em>null_dist</em></strong>.</p>
<div class="section level3">
<h3 id="the-lineup-protocol">The lineup protocol<a class="anchor" aria-label="anchor" href="#the-lineup-protocol"></a>
</h3>
<p>In this protocol, the plot of the real data is randomly embedded
amongst a set of null plots. The matrix of plots is known as a lineup.
The null plots are generated by a method consistent with the null
hypothesis. The lineup is shown to an observer. If the observer can pick
the real data as different from the others, this puts weight on the
statistical significance of the structure in the plot. The
<code>"lineup"</code> function returns a set of generated null datasets
and the real data embedded randomly among these null datasets. The
method of null generation should be provided in the lineup function for
the null datasets to be generated automatically along with the real
dataset. The users also have the option of generating the null datasets
themselves and providing them in the <code>"lineup"</code> function. The
position of the real dataset can be left missing and the function picks
the position at random. The function then returns the position as an
encrypted code. The encrypted code is copied and pasted on the console
to obtain the true position of the plot.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lineup.html">lineup</a></span><span class="op">(</span><span class="fu"><a href="../reference/null_permute.html">null_permute</a></span><span class="op">(</span><span class="st">"mpg"</span><span class="op">)</span>, <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## decrypt("DruT c2V2 AR LeOAVAeR 4d")</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       mpg cyl disp  hp drat    wt  qsec vs am gear carb .sample</span></span>
<span><span class="co">## ...1 17.3   6  160 110 3.90 2.620 16.46  0  1    4    4       1</span></span>
<span><span class="co">## ...2 15.2   6  160 110 3.90 2.875 17.02  0  1    4    4       1</span></span>
<span><span class="co">## ...3 16.4   4  108  93 3.85 2.320 18.61  1  1    4    1       1</span></span>
<span><span class="co">## ...4 18.7   6  258 110 3.08 3.215 19.44  1  0    3    1       1</span></span>
<span><span class="co">## ...5 18.1   8  360 175 3.15 3.440 17.02  0  0    3    2       1</span></span>
<span><span class="co">## ...6 10.4   6  225 105 2.76 3.460 20.22  1  0    3    1       1</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Position of actual data plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"pos"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 14</span></span></code></pre>
<p>The lineup data can be then used to generate the lineup using
<strong>ggplot2</strong>. The lineup is shown to one or more observers
who are asked to identify the plot which is different. If the observer
can identify the plot of the real data correctly, we reject the null
hypothesis and conclude that the plot of the real data has stronger
structure than the null plots.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">d</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mpg</span>, y<span class="op">=</span><span class="va">wt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.sample</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor_files/figure-html/unnamed-chunk-3-1.png" width="1056" style="display:block; margin: auto"></p>
</div>
<div class="section level3">
<h3 id="the-rorschach-protocol">The Rorschach protocol<a class="anchor" aria-label="anchor" href="#the-rorschach-protocol"></a>
</h3>
<p>The Rorschach protocol is used to calibrate the eyes for variation
due to sampling. The plots generated corresponds to the null datasets,
data that is consistent with a null hypothesis. The
<code>"rorschach"</code> function returns a set of null plots which are
shown to observers to calibrate their eyes with variation. Like the
<code>"lineup"</code> function, the null generating mechanism should be
provided as an input along with a real dataset. A probability can also
be given as input which dictates the chance of including the true data
with null data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rorschach.html">rorschach</a></span><span class="op">(</span><span class="fu"><a href="../reference/null_permute.html">null_permute</a></span><span class="op">(</span><span class="st">"mpg"</span><span class="op">)</span>, <span class="va">mtcars</span>, n <span class="op">=</span> <span class="fl">20</span>, p <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">d</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mpg</span>, y<span class="op">=</span><span class="va">wt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.sample</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor_files/figure-html/unnamed-chunk-4-1.png" width="1056" style="display:block; margin: auto"></p>
</div>
<div class="section level3">
<h3 id="generate-null-data-with-a-specific-distribution">Generate null data with a specific distribution<a class="anchor" aria-label="anchor" href="#generate-null-data-with-a-specific-distribution"></a>
</h3>
<p>The <code>"null_dist"</code> function takes as input a variable name
of the data and a particular distribution. This variable in the data is
substituted by random generations of the particular distribution. The
different distributions include beta, cauchy, chi-squared, exponential,
f, gamma, geometric, log-normal, lognormal, logistic, negative binomial,
normal, poisson, t and weibull. A list of parameters of distribution can
also be provided as input. In case it is not provided,
<code>"fitdistr"</code> is used to estimate the parameters from the
given data. The function <code>"null_dist"</code> returns a function
that given the data generates a null data set.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/null_dist.html">null_dist</a></span><span class="op">(</span><span class="st">"mpg"</span>, dist <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                         mpg cyl disp  hp drat    wt  qsec vs am gear carb</span></span>
<span><span class="co">## Mazda RX4         23.363215   6  160 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span><span class="co">## Mazda RX4 Wag      7.402564   6  160 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span><span class="co">## Datsun 710        15.388579   4  108  93 3.85 2.320 18.61  1  1    4    1</span></span>
<span><span class="co">## Hornet 4 Drive    15.963965   6  258 110 3.08 3.215 19.44  1  0    3    1</span></span>
<span><span class="co">## Hornet Sportabout 26.584730   8  360 175 3.15 3.440 17.02  0  0    3    2</span></span>
<span><span class="co">## Valiant           19.495271   6  225 105 2.76 3.460 20.22  1  0    3    1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="generate-null-data-by-permuting-a-variable">Generate null data by permuting a variable<a class="anchor" aria-label="anchor" href="#generate-null-data-by-permuting-a-variable"></a>
</h3>
<p>The <code>"null_permute"</code> function takes as input a variable
name of the data. This variable is permuted to obtain the null dataset.
The function <code>"null_dist"</code> returns a function that given the
data generates a null data set.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/null_permute.html">null_permute</a></span><span class="op">(</span><span class="st">"mpg"</span><span class="op">)</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb</span></span>
<span><span class="co">## Mazda RX4         21.4   6  160 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span><span class="co">## Mazda RX4 Wag     17.8   6  160 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span><span class="co">## Datsun 710        30.4   4  108  93 3.85 2.320 18.61  1  1    4    1</span></span>
<span><span class="co">## Hornet 4 Drive    26.0   6  258 110 3.08 3.215 19.44  1  0    3    1</span></span>
<span><span class="co">## Hornet Sportabout 21.0   8  360 175 3.15 3.440 17.02  0  0    3    2</span></span>
<span><span class="co">## Valiant           13.3   6  225 105 2.76 3.460 20.22  1  0    3    1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="generate-null-data-with-null-residuals-from-a-model">Generate null data with null residuals from a model<a class="anchor" aria-label="anchor" href="#generate-null-data-with-null-residuals-from-a-model"></a>
</h3>
<p>The function <code>"null_lm"</code> takes as input a model
specification formula as defined by <code>"lm"</code> and method for
generating null residuals from the model. The three built in methods are
‘rotate’, ‘pboot’ and ‘boot’ defined by <code>"resid_rotate"</code>,
<code>"resid_pboot"</code> and <code>"resid_boot"</code> respectively.
The function returns a function which given the data generates a null
dataset.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/null_lm.html">null_lm</a></span><span class="op">(</span><span class="va">wt</span><span class="op">~</span><span class="va">mpg</span>, method <span class="op">=</span> <span class="st">'rotate'</span><span class="op">)</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    mpg cyl disp  hp drat       wt  qsec vs am gear carb</span></span>
<span><span class="co">## Mazda RX4         21.0   6  160 110 3.90 2.091104 16.46  0  1    4    4</span></span>
<span><span class="co">## Mazda RX4 Wag     21.0   6  160 110 3.90 3.150694 17.02  0  1    4    4</span></span>
<span><span class="co">## Datsun 710        22.8   4  108  93 3.85 2.408048 18.61  1  1    4    1</span></span>
<span><span class="co">## Hornet 4 Drive    21.4   6  258 110 3.08 2.546780 19.44  1  0    3    1</span></span>
<span><span class="co">## Hornet Sportabout 18.7   8  360 175 3.15 3.568762 17.02  0  0    3    2</span></span>
<span><span class="co">## Valiant           18.1   6  225 105 2.76 4.381137 20.22  1  0    3    1</span></span>
<span><span class="co">##                        .resid  .fitted</span></span>
<span><span class="co">## Mazda RX4         -0.99804946 3.089154</span></span>
<span><span class="co">## Mazda RX4 Wag      0.06154012 3.089154</span></span>
<span><span class="co">## Datsun 710        -0.42755446 2.835602</span></span>
<span><span class="co">## Hornet 4 Drive    -0.48602857 3.032809</span></span>
<span><span class="co">## Hornet Sportabout  0.15562583 3.413136</span></span>
<span><span class="co">## Valiant            0.88348341 3.497653</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="generate-null-data-outside-of-nullabor">Generate null data outside of nullabor<a class="anchor" aria-label="anchor" href="#generate-null-data-outside-of-nullabor"></a>
</h3>
<p>If the null generating mechanism is specialised it is worth creating
the process outside of the nullabor package. The <code>lineup</code>
function can be simply used to randomize the position of the data plot
to produce a lineup, encrypting the position. An example of this is in
Roy Chowdhury, N. et al (2015), where the data is high-dimensional, and
the response variable is categorical. We would use a dimension reduction
method like linear discrimants to find a low-dimensional projection that
separates the groups. To generate null data, the group labels are
permuted and the dimension reduction is performed again.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'MASS'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     select</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wasps</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wasp.lda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">lda</a></span><span class="op">(</span><span class="va">Group</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">wasps</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">wasp.ld</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">wasp.lda</span>, dimen<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="va">true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">wasp.ld</span>, Group<span class="op">=</span><span class="va">wasps</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wasp.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>LD1<span class="op">=</span><span class="cn">NULL</span>, LD2<span class="op">=</span><span class="cn">NULL</span>, Group<span class="op">=</span><span class="cn">NULL</span>, .n<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">wasps</span></span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">Group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span></span>
<span>  <span class="va">x.lda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">lda</a></span><span class="op">(</span><span class="va">Group</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">x</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">x.ld</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">x.lda</span>, dimen<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">x</span></span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x.ld</span>, Group<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">Group</span>, .n<span class="op">=</span><span class="va">i</span><span class="op">)</span></span>
<span>  <span class="va">wasp.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">wasp.sim</span>, <span class="va">sim</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lineup.html">lineup</a></span><span class="op">(</span>true<span class="op">=</span><span class="va">true</span>, samples<span class="op">=</span><span class="va">wasp.sim</span>, pos<span class="op">=</span><span class="va">pos</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">LD1</span>, y<span class="op">=</span><span class="va">LD2</span>, colour<span class="op">=</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">.sample</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display:block; margin: auto"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"pos"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="computing-p-values">Computing p-values<a class="anchor" aria-label="anchor" href="#computing-p-values"></a>
</h3>
<p>The function <code>pvisual</code> can be used to compute a visual
p-value after the lineup has been shown to a group of independent
observers. You need to provide (1) number of plots in the lineup, m
(default=20), (2) number of observers who read the plot, K, and (3) the
number of observers who picked the data plot. For the above example,
suppose that 10 observers evaluated the lineup, and of these 4 selected
the data plot, then the visual p-value, calculated using the binomial,
and via simulation to account for dependencies is:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pvisual.html">pvisual</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      x simulated       binom</span></span>
<span><span class="co">## [1,] 4    0.0027 0.001028498</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="computing-power">Computing power<a class="anchor" aria-label="anchor" href="#computing-power"></a>
</h3>
<p>The function <code>visual_power</code> can be used to compute the
power of each lineup. This is an example using the sample turk results
provided.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">turk_results</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/visual_power.html">visual_power</a></span><span class="op">(</span><span class="va">turk_results</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">##   pic_id power     n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     36 0        18</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>    105 0.746    17</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>    116 0.125    16</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>    131 0.842    14</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>    159 0.656    15</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>    225 0.130    15</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Buja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E.-K., Swayne, D.
F, Wickham, H. (2009) Statistical Inference for Exploratory Data
Analysis and Model Diagnostics, Royal Society Philosophical Transactions
A, 367:4361–4383, DOI: 10.1098/rsta.2009.0120.</p>
<p>Wickham, H., Cook, D., Hofmann, H. and Buja, A. (2010) Graphical
Inference for Infovis, IEEE Transactions on Visualization and Computer
Graphics, 16(6):973–979, Best paper award, DOI:
10.1109/TVCG.2010.161.</p>
<p>Hofmann, H., Follett, L., Majumder, M. and Cook, D. (2012) Graphical
Tests for Power Comparison of Competing Designs, IEEE Transactions on
Visualization and Computer Graphics, 18(12):2441–2448, DOI:
10.1109/TVCG.2012.230.</p>
<p>Majumder, M., Hofmann, H. and Cook, D. (2013) Validation of Visual
Statistical Inference, Applied to Linear Models, Journal of the American
Statistical Association, 108(503):942–956, Featured Article, DOI:
10.1080/01621459.2013.808157.</p>
<p>Roy Chowdhury, N., Cook, D., Hofmann, H., Majumder, M., Lee, E. K.,
&amp; Toth, A. L. (2014). Using visual statistical inference to better
understand random class separations in high dimension, low sample size
data. Computational Statistics, 30(2), 293-316, DOI:
10.1007/s00180-014-0534-x.</p>
<p>Majumder, M. and Hofmann, H. and Cook, D. (2014) Human Factors
Influencing Visual Statistical Inference, DOI:
10.48550/arXiv.1408.1974.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hadley Wickham, Niladri Roy Chowdhury, Di Cook, Heike Hofmann, Måns Thulin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
