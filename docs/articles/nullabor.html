<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to the nullabor package • nullabor</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to the nullabor package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nullabor</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nullabor.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/distances.html">Distances between null and data plots</a>
    </li>
    <li>
      <a href="../articles/nullabor-examples.html">Example lineups</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/dicook/nullabor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>An Introduction to the nullabor package</h1>
            
      
      <small class="dont-index">Source: <a href="http://github.com/dicook/nullabor/blob/master/vignettes/nullabor.Rmd"><code>vignettes/nullabor.Rmd</code></a></small>
      <div class="hidden name"><code>nullabor.Rmd</code></div>

    </div>

    
    
<div id="an-introduction-to-the-nullabor-package" class="section level1">
<h1 class="hasAnchor">
<a href="#an-introduction-to-the-nullabor-package" class="anchor"></a>An introduction to the <strong>nullabor</strong> package</h1>
<p>The <strong>nullabor</strong> package provides functions to support quantifying the significance of structure seen in plots of data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(nullabor)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<p>The functions provide methods for two protocols: <strong><em>lineup</em></strong> and <strong><em>rorschach</em></strong>. The lineup protocol places the plot of the actual data among a field of plots of null data, and in the Rorschach, all plots are of null data. The <strong><em>encrypt</em></strong> function enables the location of the actual data plot to be a secret, that needs <strong><em>decrypt</em></strong> to reveal. There are several different functions for generating null data sets: <strong><em>null_permute</em></strong>, <strong><em>null_lm</em></strong> and <strong><em>null_dist</em></strong>.</p>
<div id="the-lineup-protocol" class="section level2">
<h2 class="hasAnchor">
<a href="#the-lineup-protocol" class="anchor"></a>The lineup protocol</h2>
<p>In this protocol, the plot of the real data is randomly embedded amongst a set of null plots. The matrix of plots is known as a lineup. The null plots are generated by a method consistent with the null hypothesis. The lineup is shown to an observer. If the observer can pick the real data as different from the others, this puts weight on the statistical significance of the structure in the plot. The <code>"lineup"</code> function returns a set of generated null datasets and the real data embedded randomly among these null datasets. The method of null generation should be provided in the lineup function for the null datasets to be generated automatically along with the real dataset. The users also have the option of generating the null datasets themselves and providing them in the <code>"lineup"</code> function. The position of the real dataset can be left missing and the function picks the position at random. The function then returns the position as an encrypted code. The encrypted code is copied and pasted on the console to obtain the true position of the plot.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lineup.html">lineup</a></span>(<span class="kw"><a href="../reference/null_permute.html">null_permute</a></span>(<span class="st">"mpg"</span>), mtcars)</a></code></pre></div>
<pre><code>## decrypt("7OPa 86t6 XR fJ3XtXJR Gj")</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>##    mpg cyl disp  hp drat    wt  qsec vs am gear carb .sample
## 1 18.1   6  160 110 3.90 2.620 16.46  0  1    4    4       1
## 2 33.9   6  160 110 3.90 2.875 17.02  0  1    4    4       1
## 3 15.2   4  108  93 3.85 2.320 18.61  1  1    4    1       1
## 4 21.0   6  258 110 3.08 3.215 19.44  1  0    3    1       1
## 5 16.4   8  360 175 3.15 3.440 17.02  0  0    3    2       1
## 6 24.4   6  225 105 2.76 3.460 20.22  1  0    3    1       1</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Position of actual data plot</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">attr</span>(d, <span class="st">"pos"</span>)</a></code></pre></div>
<pre><code>## [1] 16</code></pre>
<p>The lineup data can be then used to generate the lineup using <strong>ggplot2</strong>. The lineup is shown to one or more observers who are asked to identify the plot which is different. If the observer can identify the plot of the real data correctly, we reject the null hypothesis and conclude that the plot of the real data has stronger structure than the null plots.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="dt">data=</span>d, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>mpg, <span class="dt">y=</span>wt)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span><span class="st"> </span>.sample)</a></code></pre></div>
<p><img src="nullabor_files/figure-html/unnamed-chunk-3-1.png" width="1056" style="display:block; margin: auto"></p>
</div>
<div id="the-rorschach-protocol" class="section level2">
<h2 class="hasAnchor">
<a href="#the-rorschach-protocol" class="anchor"></a>The Rorschach protocol</h2>
<p>The Rorschach protocol is used to calibrate the eyes for variation due to sampling. The plots generated corresponds to the null datasets, data that is consistent with a null hypothesis. The <code>"rorschach"</code> function returns a set of null plots which are shown to observers to calibrate their eyes with variation. Like the <code>"lineup"</code> function, the null generating mechanism should be provided as an input along with a real dataset. A probability can also be given as input which dictates the chance of including the true data with null data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rorschach.html">rorschach</a></span>(<span class="kw"><a href="../reference/null_permute.html">null_permute</a></span>(<span class="st">"mpg"</span>), mtcars, <span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">p =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="dt">data=</span>d, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>mpg, <span class="dt">y=</span>wt)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span><span class="st"> </span>.sample)</a></code></pre></div>
<p><img src="nullabor_files/figure-html/unnamed-chunk-4-1.png" width="1056" style="display:block; margin: auto"></p>
</div>
<div id="generate-null-data-with-a-specific-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-null-data-with-a-specific-distribution" class="anchor"></a>Generate null data with a specific distribution</h2>
<p>The <code>"null_dist"</code> function takes as input a variable name of the data and a particular distribution. This variable in the data is substituted by random generations of the particular distribution. The different distributions include beta, cauchy, chi-squared, exponential, f, gamma, geometric, log-normal, lognormal, logistic, negative binomial, normal, poisson, t and weibull. A list of parameters of distribution can also be provided as input. In case it is not provided, <code>"fitdistr"</code> is used to estimate the parameters from the given data. The function <code>"null_dist"</code> returns a function that given the data generates a null data set.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">head</span>(<span class="kw"><a href="../reference/null_dist.html">null_dist</a></span>(<span class="st">"mpg"</span>, <span class="dt">dist =</span> <span class="st">"normal"</span>)(mtcars))</a></code></pre></div>
<pre><code>##                        mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         16.43692   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     13.25943   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        15.98654   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    25.24992   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 21.06052   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           19.04074   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
<div id="generate-null-data-by-permuting-a-variable" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-null-data-by-permuting-a-variable" class="anchor"></a>Generate null data by permuting a variable</h2>
<p>The <code>"null_permute"</code> function takes as input a variable name of the data. This variable is permuted to obtain the null dataset. The function <code>"null_dist"</code> returns a function that given the data generates a null data set.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">head</span>(<span class="kw"><a href="../reference/null_permute.html">null_permute</a></span>(<span class="st">"mpg"</span>)(mtcars))</a></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         15.2   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     30.4   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        18.7   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    17.3   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 22.8   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           17.8   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
<div id="generate-null-data-with-null-residuals-from-a-model" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-null-data-with-null-residuals-from-a-model" class="anchor"></a>Generate null data with null residuals from a model</h2>
<p>The function <code>"null_lm"</code> takes as input a model specification formula as defined by <code>"lm"</code> and method for generating null residuals from the model. The three built in methods are ‘rotate’, ‘pboot’ and ‘boot’ defined by <code>"resid_rotate"</code>, <code>"resid_pboot"</code> and <code>"resid_boot"</code> respectively. The function returns a function which given the data generates a null dataset.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">head</span>(<span class="kw"><a href="../reference/null_lm.html">null_lm</a></span>(wt<span class="op">~</span>mpg, <span class="dt">method =</span> <span class="st">'rotate'</span>)(mtcars))</a></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat       wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 3.123887 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 3.056918 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.933520 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 2.806303 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.866555 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 2.546959 20.22  1  0    3    1
##                        .resid  .fitted
## Mazda RX4          0.03473384 3.089154
## Mazda RX4 Wag     -0.03223526 3.089154
## Datsun 710         0.09791756 2.835602
## Hornet 4 Drive    -0.22650539 3.032809
## Hornet Sportabout  0.45341835 3.413136
## Valiant           -0.95069392 3.497653</code></pre>
</div>
<div id="generate-null-data-outside-of-nullabor" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-null-data-outside-of-nullabor" class="anchor"></a>Generate null data outside of nullabor</h2>
<p>If the null generating mechanism is specialised it is worth creating the process outside of the nullabor package. The <code>lineup</code> function can be simply used to randomize the position of the data plot to produce a lineup, encrypting the position. An example of this is in Roy Chowdhury, N. et al (2015), where the data is high-dimensional, and the response variable is categorical. We would use a dimension reduction method like linear discrimants to find a low-dimensional projection that separates the groups. To generate null data, the group labels are permuted and the dimension reduction is performed again.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'MASS'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     select</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">data</span>(wasps)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">wasp.lda &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/MASS/topics/lda">lda</a></span>(Group<span class="op">~</span>., <span class="dt">data=</span>wasps[,<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">wasp.ld &lt;-<span class="st"> </span><span class="kw">predict</span>(wasp.lda, <span class="dt">dimen=</span><span class="dv">2</span>)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">true &lt;-<span class="st"> </span><span class="kw">data.frame</span>(wasp.ld, <span class="dt">Group=</span>wasps<span class="op">$</span>Group)</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"></a>
<a class="sourceLine" id="cb19-7" data-line-number="7">wasp.sim &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">LD1=</span><span class="ot">NULL</span>, <span class="dt">LD2=</span><span class="ot">NULL</span>, <span class="dt">Group=</span><span class="ot">NULL</span>, <span class="dt">.n=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) {</a>
<a class="sourceLine" id="cb19-9" data-line-number="9">  x &lt;-<span class="st"> </span>wasps</a>
<a class="sourceLine" id="cb19-10" data-line-number="10">  x<span class="op">$</span>Group &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/sample">sample</a></span>(x<span class="op">$</span>Group)</a>
<a class="sourceLine" id="cb19-11" data-line-number="11">  x.lda &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/MASS/topics/lda">lda</a></span>(Group<span class="op">~</span>., <span class="dt">data=</span>x[,<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb19-12" data-line-number="12">  x.ld &lt;-<span class="st"> </span><span class="kw">predict</span>(x.lda, <span class="dt">dimen=</span><span class="dv">2</span>)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb19-13" data-line-number="13">  sim &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x.ld, <span class="dt">Group=</span>x<span class="op">$</span>Group, <span class="dt">.n=</span>i)</a>
<a class="sourceLine" id="cb19-14" data-line-number="14">  wasp.sim &lt;-<span class="st"> </span><span class="kw">rbind</span>(wasp.sim, sim)</a>
<a class="sourceLine" id="cb19-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb19-16" data-line-number="16"></a>
<a class="sourceLine" id="cb19-17" data-line-number="17">pos &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-18" data-line-number="18">d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lineup.html">lineup</a></span>(<span class="dt">true=</span>true, <span class="dt">samples=</span>wasp.sim, <span class="dt">pos=</span>pos)</a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(d, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>LD1, <span class="dt">y=</span>LD2, <span class="dt">colour=</span>Group)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-20" data-line-number="20"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>.sample, <span class="dt">ncol=</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-21" data-line-number="21"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">aspect.ratio=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="nullabor_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display:block; margin: auto"></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">attr</span>(d, <span class="st">"pos"</span>)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="computing-p-values" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-p-values" class="anchor"></a>Computing p-values</h2>
<p>The function <code>pvisual</code> can be used to compute a visual p-value after the lineup has been shown to a group of independent observers. You need to provide (1) number of plots in the lineup, m (default=20), (2) number of observers who read the plot, K, and (3) the number of observers who picked the data plot. For the above example, suppose that 10 observers evaluated the lineup, and of these 4 selected the data plot, then the visual p-value, calculated using the binomial, and via simulation to account for dependencies is:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="../reference/pvisual.html">pvisual</a></span>(<span class="dv">4</span>, <span class="dv">10</span>)</a></code></pre></div>
<pre><code>##      x simulated       binom
## [1,] 4    0.0024 0.001028498</code></pre>
</div>
<div id="computing-power" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-power" class="anchor"></a>Computing power</h2>
<p>The function <code>visual_power</code> can be used to compute the power of each lineup. This is an example using the sample turk results provided.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">data</span>(turk_results)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw"><a href="../reference/visual_power.html">visual_power</a></span>(turk_results)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   pic_id power     n
##    &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
## 1     36 0        18
## 2    105 0.746    17
## 3    116 0.125    16
## 4    131 0.842    14
## 5    159 0.656    15
## 6    225 0.130    15</code></pre>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Buja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E.-K., Swayne, D. F, Wickham, H. (2009) Statistical Inference for Exploratory Data Analysis and Model Diagnostics, Royal Society Philosophical Transactions A, 367:4361–4383.</p>
<p>Wickham, H., Cook, D., Hofmann, H. and Buja, A. (2010) Graphical Inference for Infovis, IEEE Transactions on Visualization and Computer Graphics, 16(6):973–979, <a href="http://doi.ieeecomputersociety.org/10.1109/TVCG.2010.161" class="uri">http://doi.ieeecomputersociety.org/10.1109/TVCG.2010.161</a>. Best paper award.</p>
<p>Hofmann, H., Follett, L., Majumder, M. and Cook, D. (2012) Graphical Tests for Power Comparison of Competing Designs, IEEE Transactions on Visualization and Computer Graphics, 18(12):2441–2448, <a href="ttp://doi.ieeecomputersociety.org/10.1109/TVCG.2012.230">http://doi.ieeecomputersociety.org/10.1109/TVCG.2012.230</a>.</p>
<p>Majumder, M., Hofmann, H. and Cook, D. (2013) Validation of Visual Statistical Inference, Applied to Linear Models, Journal of the American Statistical Association, 108(503):942–956. Featured Article <a href="http://amstat.tandfonline.com/doi/pdf/10.1080/01621459.2013.808157" class="uri">http://amstat.tandfonline.com/doi/pdf/10.1080/01621459.2013.808157</a>.</p>
<p>Roy Chowdhury, N., Cook, D., Hofmann, H., Majumder, M., Lee, E. K., &amp; Toth, A. L. (2014). Using visual statistical inference to better understand random class separations in high dimension, low sample size data. Computational Statistics, 30(2), 293-316. <a href="http://dx.doi.org/10.1007/s00180-014-0534-x">10.1007/s00180-014-0534-x</a></p>
<p>Majumder, M. and Hofmann, H. and Cook, D. (2014) Human Factors Influencing Visual Statistical Inference, <a href="http://arxiv.org/abs/1408.1974" class="uri">http://arxiv.org/abs/1408.1974</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#an-introduction-to-the-nullabor-package">An introduction to the <strong>nullabor</strong> package</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-lineup-protocol">The lineup protocol</a></li>
      <li><a href="#the-rorschach-protocol">The Rorschach protocol</a></li>
      <li><a href="#generate-null-data-with-a-specific-distribution">Generate null data with a specific distribution</a></li>
      <li><a href="#generate-null-data-by-permuting-a-variable">Generate null data by permuting a variable</a></li>
      <li><a href="#generate-null-data-with-null-residuals-from-a-model">Generate null data with null residuals from a model</a></li>
      <li><a href="#generate-null-data-outside-of-nullabor">Generate null data outside of nullabor</a></li>
      <li><a href="#computing-p-values">Computing p-values</a></li>
      <li><a href="#computing-power">Computing power</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Di Cook, <a href="http://hadley.nz">Hadley Wickham</a>, Niladri Roy Chowdhury, Heike Hofmann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
