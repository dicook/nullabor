<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assessing distributional assumptions using the nullabor package • nullabor</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Assessing distributional assumptions using the nullabor package">
<meta property="og:description" content="nullabor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nullabor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/nullabor.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/distances.html">Distances between null and data plots</a>
    </li>
    <li>
      <a href="../articles/nullabor-distributions.html">Assessing distributional assumptions using the nullabor package</a>
    </li>
    <li>
      <a href="../articles/nullabor-examples.html">Example lineups</a>
    </li>
    <li>
      <a href="../articles/nullabor-regression.html">Residual plots for linear models using the nullabor package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dicook/nullabor/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Assessing distributional assumptions using the
nullabor package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dicook/nullabor/blob/HEAD/vignettes/nullabor-distributions.Rmd" class="external-link"><code>vignettes/nullabor-distributions.Rmd</code></a></small>
      <div class="hidden name"><code>nullabor-distributions.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="assessing-distributional-assumptions-using-the-nullabor-package">Assessing distributional assumptions using the
<strong>nullabor</strong> package<a class="anchor" aria-label="anchor" href="#assessing-distributional-assumptions-using-the-nullabor-package"></a>
</h2>
<p>The <strong>nullabor</strong> package provides functions to visually
assess distributional assumptions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dicook/nullabor" class="external-link">nullabor</a></span><span class="op">)</span></span></code></pre></div>
<p>Start by specifying the distribution family under the null
hypothesis. The options available are:</p>
<ul>
<li>Beta distribution: <code>beta</code>
</li>
<li>Cauchy distribution: <code>cauchy</code>
</li>
<li>
<span class="math inline">\(\chi^2\)</span> distribution:
<code>chi-squared</code>
</li>
<li>Gamma distribution: <code>gamma</code>
</li>
<li>Geometric distribution: <code>geometric</code>
</li>
<li>Lognormal distribution: <code>lognormal</code>
</li>
<li>Logistic distribution: <code>logistic</code>
</li>
<li>Negative binomial distribution: <code>negative binomial</code>
</li>
<li>Binomial distribution: <code>binomial</code>
</li>
<li>Normal distribution: <code>normal</code>
</li>
<li>Poisson distribution: <code>poisson</code>
</li>
<li>Student’s t distribution: <code>t</code>
</li>
<li>Uniform distribution: <code>uniform</code>
</li>
<li>Weibull distribution: <code>weibull</code>
</li>
</ul>
<p>You can also specify the parameters of the distribution. This is
required for uniform, beta, and binomial distributions.</p>
<div class="section level3">
<h3 id="using-histograms">Using histograms<a class="anchor" aria-label="anchor" href="#using-histograms"></a>
</h3>
<p>The first option is to use histograms with kernel density
estimates.</p>
<p>To test the hypothesis that the variable <code>total_bill</code> in
the <code>tips</code> dataset follows a normal distribution, we draw a
histogram lineup plot using <code>lineup_histograms</code> as
follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tips</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/lineup_histograms.html">lineup_histograms</a></span><span class="op">(</span><span class="va">tips</span>, <span class="st">"total_bill"</span>, dist <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor-distributions_files/figure-html/unnamed-chunk-2-1.png" width="700" style="display:block; margin: auto"></p>
<p>Run the <code>decrypt</code> code printed in the Console to see which
plot belongs to the <code>tips</code> data.</p>
<p>To instead test the hypothesis that the data follow a gamma
distribution, we use <code>dist = "gamma"</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lineup_histograms.html">lineup_histograms</a></span><span class="op">(</span><span class="va">tips</span>, <span class="st">"total_bill"</span>, dist <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor-distributions_files/figure-html/unnamed-chunk-3-1.png" width="700" style="display:block; margin: auto"></p>
<div class="section level4">
<h4 id="specifying-distribution-parameters">Specifying distribution parameters<a class="anchor" aria-label="anchor" href="#specifying-distribution-parameters"></a>
</h4>
<p>In some cases, we need (or want) to specify the entire distribution,
and not just the family. We then provide the distribution parameters,
using the standard format for the distribution (i.e. the same used by
<code>r*</code>, <code>d*</code>, <code>p*</code>, and <code>q*</code>
functions, where <code>*</code> is the distribution name).</p>
<p>As an example, let’s say that we want to test whether a dataset comes
from a uniform <span class="math inline">\(U(0,1)\)</span> distribution.
First, we generate two example variables. <code>x1</code> is <span class="math inline">\(U(0,1)\)</span>, but <code>x2</code> is not.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                           x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>For the uniform distribution, the parameters are <code>min</code> and
<code>max</code> (see <code><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">?dunif</a></code>). To test whether the
<code>x1</code> data come from a <span class="math inline">\(U(0,1)\)</span> distribution, we specify the
distribution parameters as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lineup_histograms.html">lineup_histograms</a></span><span class="op">(</span><span class="va">example_data</span>, <span class="st">"x1"</span>, dist <span class="op">=</span> <span class="st">"uniform"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor-distributions_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display:block; margin: auto"></p>
<p>And for <code>x2</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lineup_histograms.html">lineup_histograms</a></span><span class="op">(</span><span class="va">example_data</span>, <span class="st">"x2"</span>, dist <span class="op">=</span> <span class="st">"uniform"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor-distributions_files/figure-html/unnamed-chunk-6-1.png" width="700" style="display:block; margin: auto"></p>
</div>
</div>
<div class="section level3">
<h3 id="using-q-q-plots">Using Q-Q plots<a class="anchor" aria-label="anchor" href="#using-q-q-plots"></a>
</h3>
<p>An alternative to histograms is to use quantile-quantile plots, in
which the theoretical quantiles of the distribution are compared to the
empirical quantiles from the (standardized) data. Under the null
hypothesis, the points should lie along the reference line. However,
some deviations in the tails are usually expected. A lineup plot is
useful to see how much points can deviate from the reference line under
the null hypothesis.</p>
<p>To create a Q-Q lineup plot using the normal distribution as the null
distribution, use <code>lineup_qq</code> as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lineup_qq.html">lineup_qq</a></span><span class="op">(</span><span class="va">tips</span>, <span class="st">"total_bill"</span>, dist <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor-distributions_files/figure-html/unnamed-chunk-7-1.png" width="700" style="display:block; margin: auto"></p>
<p>Again, some distributions require parameters to be specified. This is
done analogously to how we did it for histograms:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lineup_qq.html">lineup_qq</a></span><span class="op">(</span><span class="va">example_data</span>, <span class="st">"x1"</span>, dist <span class="op">=</span> <span class="st">"uniform"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor-distributions_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display:block; margin: auto"></p>
</div>
<div class="section level3">
<h3 id="changing-plot-appearance">Changing plot appearance<a class="anchor" aria-label="anchor" href="#changing-plot-appearance"></a>
</h3>
<p>For both histograms and Q-Q plots, you can style the plot using
arguments for color and opacity, as well as using <code>ggplot2</code>
functions like <code>theme</code>.</p>
<p>Histograms:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/lineup_histograms.html">lineup_histograms</a></span><span class="op">(</span><span class="va">example_data</span>, <span class="st">"x1"</span>,</span>
<span>                  dist <span class="op">=</span> <span class="st">"uniform"</span>,</span>
<span>                  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                  color_bars <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                  fill_bars <span class="op">=</span> <span class="st">"#416B4B"</span>,</span>
<span>                  color_lines <span class="op">=</span> <span class="st">"#7D5AAD"</span></span>
<span>                  <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor-distributions_files/figure-html/unnamed-chunk-9-1.png" width="700" style="display:block; margin: auto"></p>
<p>Q-Q plots:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lineup_qq.html">lineup_qq</a></span><span class="op">(</span><span class="va">tips</span>, <span class="st">"total_bill"</span>,</span>
<span>          dist <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>          color_points <span class="op">=</span> <span class="st">"cyan"</span>,</span>
<span>          color_lines <span class="op">=</span> <span class="st">"#ED11B7"</span>,</span>
<span>          alpha_points <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"navy"</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"mono"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="nullabor-distributions_files/figure-html/unnamed-chunk-10-1.png" width="700" style="display:block; margin: auto"></p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Buja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E.-K., Swayne, D.
F, Wickham, H. (2009) Statistical Inference for Exploratory Data
Analysis and Model Diagnostics, Royal Society Philosophical Transactions
A, 367:4361–4383, DOI: 10.1098/rsta.2009.0120.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hadley Wickham, Niladri Roy Chowdhury, Di Cook, Heike Hofmann, Måns Thulin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
